
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Bonaventura Tagliafierro">
      
      
        <link rel="canonical" href="https://btagliafierro.github.io/im-power/figures/fundamentals/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>SPH implementation in DualSPHysics - IM-POWER</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.35f28582.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      

  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 12a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M6 13h8l-3.5 3.5 1.42 1.42L17.84 12l-5.92-5.92L10.5 7.5 14 11H6z"/></svg>');}</style>


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../meta">
    
      <link rel="stylesheet" href="../../admonition">
    
      <link rel="stylesheet" href="../../stylesheets/custom.css">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sph_formulation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://example.com" title="IM-POWER" class="md-header__button md-logo" aria-label="IM-POWER" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            IM-POWER
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SPH implementation in DualSPHysics
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../pages/" class="md-tabs__link">
        
  
    
  
  Main

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../pages/background/" class="md-tabs__link">
        
  
    
  
  Background

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../pages/overview/" class="md-tabs__link">
        
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../pages/implementation/" class="md-tabs__link">
        
  
    
  
  Implementation

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../pages/code/" class="md-tabs__link">
          
  
  Software

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../pages/outcome/" class="md-tabs__link">
        
  
    
  
  Outcome

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../pages/contact/" class="md-tabs__link">
        
  
    
  
  Contact

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://example.com" title="IM-POWER" class="md-nav__button md-logo" aria-label="IM-POWER" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    IM-POWER
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Main
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pages/background/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Background
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pages/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pages/implementation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Implementation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Software
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Software
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pages/code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pages/outcome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Outcome
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pages/contact/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contact
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="sph_formulation"><strong>SPH Formulation</strong><a class="headerlink" href="#sph_formulation" title="Permanent link">&para;</a></h1>
<p>Smoothed Particle Hydrodynamics (SPH) is a Lagrangian meshless method. The
technique discretises a continuum using a set of material points or particles. When used
for the simulation of fluid dynamics, the discretised Navier-Stokes equations are locally
integrated at the location of each of these particles, according to the physical properties
of surrounding particles. The set of neighbouring particles is determined by a distance
based function, either circular (two-dimensional) or spherical (three-dimensional), with
an associated characteristic length or smoothing length often denoted as <span class="arithmatex">\(h\)</span>. At each timestep
new physical quantities are calculated for each particle, and they then move
according to the updated values.</p>
<div style="background-color: #e6f3ff; padding: 15px; border-left: 5px solid #3498db; margin-bottom: 15px;">
<strong>Note:</strong> The conservation laws of continuum fluid dynamics are transformed from their partial differential form to a form suitable for particle based simulation using integral equations based on an interpolation function, which gives an estimate of values at a specific point.
</div>

<h1 id="sph_fundamentals"><strong>SPH Fundamentals</strong><a class="headerlink" href="#sph_fundamentals" title="Permanent link">&para;</a></h1>
<p>Typically this interpolation or weighting function is referred to as the kernel function
<span class="arithmatex">\(W\)</span> and can take different forms, with the most common being cubic or quintic. In all
cases however, it is designed to represent a function <span class="arithmatex">\(F(\mathbf{r})\)</span>  defined in <span class="arithmatex">\(\mathbf{r}'\)</span> by the integral approximation:</p>
<div class="arithmatex">\[\begin{equation}
\tag{1}\label{sph} 
  \text{F}(\mathbf{r})=\int_{\Omega}{F(\mathbf{r}') W(\mathbf{r}-\mathbf{r}')\text{d}\mathbf{r}'},
\end{equation}\]</div>
<p>where <span class="arithmatex">\(\mathbf{r}\)</span> is the pointee and <span class="arithmatex">\(\mathbf{r}'\)</span> a ne</p>
<p>The smoothing kernel must fulfil several properties (<a href="#Monaghan1992" title="I'm a tooltip!">Monaghan 1992</a>), Lorem ipsum<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup> dolor sit amet, consectetur adipiscing elit.[^2] such as positivity inside a defined zone of interaction, compact support, normalization and monotonically decreasing value with distance and differentiability. For a more complete description of SPH, the reader is referred to [Monaghan, 2005; Violeau, 2013].</p>
<p><a href="https://example.com" title="I'm a tooltip!">Hover me</a></p>
<p>The function <span class="arithmatex">\(F\)</span> in Equation \eqref{sph} can be approximated in a non-continuous, discrete form based
on the set of particles. In this case the function is interpolated at a particle (<span class="arithmatex">\(a\)</span>) where a
summation is performed over all the particles that fall within its region of compact
support, as defined by the smoothing length <span class="arithmatex">\(h\)</span></p>
<p>$$$$</p>
<div class="arithmatex">\[\begin{eqnarray}\tag{2}%
\frac{d\mathbf{v}_{a}}{dt}&amp;=&amp;-\sum_{b}m_{b}\Pi_{ab}\nabla_{a}W_{ab}
\end{eqnarray}\]</div>
<div class="arithmatex">\[\begin{eqnarray}\tag{4}\label{ccc}%
\text{F}(\mathbf{r}_a) \approx \sum_{b}  \text{F}(\mathbf{r}_b) W(\mathbf{r}_a - \mathbf{r}_{b}, h) \text{F}_j &amp;=&amp; \sum_{j}  \frac{m_j}{\rho_j} W(\mathbf{r} - \mathbf{r}_{j}, h) \text{F}_j,\\
y &amp;=&amp; x^4 + 4   \nonumber   \\
&amp;=&amp; (x^2+2)^2 -4x^2  \\
&amp;\le&amp;(x^2+2)^2    \nonumber
\end{eqnarray}\]</div>
<p>where the subscript denotes an individual particle, <em>v</em><sub><em>b</em></sub> is the volume of a neighbouring particle (<em>b</em>). If 
<em>v</em><sub><em>b</em></sub>=<em>m</em><sub><em>b</em></sub>/<em>ρ</em><sub><em>b</em></sub>, with <em>m</em> and <em>ρ</em> being the mass and the density of particle <em>b</em> respectively then Eq. (2) becomes</p>
<p align="center">
<img src="https://i.imgur.com/rqu0cyp.png"/> (3)
</p>

<h2 id="smoothing_kernel">Smoothing kernel<a class="headerlink" href="#smoothing_kernel" title="Permanent link">&para;</a></h2>
<p>The performance of an SPH model depends heavily on the choice of the smoothing kernel. Kernels are expressed as a function of the non-dimensional distance between particles (<em>q</em>), given by <em>q</em>=<em>r</em>/<em>h</em> , where <em>r</em> is the distance between any two given particles a and b and the parameter <em>h</em> (the smoothing length) controls the size of the area around particle a in which neighbouring particles are considered. Within DualSPHysics, the user is able to choose from one of the following kernel definitions:</p>
<h4 id="cubic_spline_monaghan_and_lattanzio_1985">Cubic Spline [Monaghan and Lattanzio, 1985]<a class="headerlink" href="#cubic_spline_monaghan_and_lattanzio_1985" title="Permanent link">&para;</a></h4>
<p>\begin{equation}
\Gamma_a = \sum_{b}m_b \frac{4 \sum{0}r_{ab}\cdot a W_{ab}}{(\rho_a + \rho_b)( r_{ab}^2 + 0.01h^2 )}
\end{equation}
where α<sub>D</sub> is equal to 10/7πh<sup>2</sup> in 2-D and 1/πh<sup>3</sup> in 3-D.</p>
<p>The tensile correction method, proposed by [Monaghan, 2000], is only actively used in
the cases of a kernel whose first derivative goes to zero with the particle distance q.</p>
<h4 id="quintic_wendland_1995">Quintic [Wendland, 1995]<a class="headerlink" href="#quintic_wendland_1995" title="Permanent link">&para;</a></h4>
<p>\tag{5} \label{hhh} 
\begin{eqnarray}
&amp;(1-r / h)^{5}-6(2 / 3-r / h)^{5}+15(1 / 3-r / h)^{5}, &amp; 0 \leq r / h&lt;1 / 3, \
&amp;(1-r / h)^{5}-6(2 / 3-r / h)^{5}, &amp; 1 / 3 \leq r / h&lt;2 / 3, \
&amp;(1-r / h)^{5}, &amp; 2 / 3 \leq r / h&lt;1, \
    &amp;0, &amp; r / h \geq 1 .
\end{eqnarray}</p>
<p>where α<sub>D</sub> is equal to 7/4πh<sup>2</sup> in 2-D and 21/16πh<sup>3</sup> in 3-D.</p>
<div class="arithmatex">\[\require{color}
\frac{\displaystyle
  {\overbrace{x^{n}}^{\text{the $k=0$ term}}} + 
  {\overbrace{\color{blue} \binom{n}{n-1}x^{n-1}h^{1}}^{\text{the $k=1$ term}}} +
  {\overbrace{\color{red} \sum_{k=2}^{k=n}\binom{n}{n-k}x^{n-k}h^{k}}^
    {\text{the terms from $k=2$ to $k=n$}}- x^n}}
  {h}
\]</div>
<p>In the text that follows, only kernels with an influence domain of 2 <em>h</em> are
considered.</p>
<h3 id="momentum_equation">Momentum Equation<a class="headerlink" href="#momentum_equation" title="Permanent link">&para;</a></h3>
<p>The momentum conservation equation in a continuum is</p>
<p align="center">
<img src="https://i.imgur.com/5tlgjt0.png"/> (6)
</p>

<p>where <strong><em>Γ</em></strong> refers to dissipative terms and <strong><em>g</em></strong> is gravitational acceleration. DualSPHysics
offers different options for including the effects of dissipation.</p>
<h3 id="artificial_viscosity">Artificial Viscosity<a class="headerlink" href="#artificial_viscosity" title="Permanent link">&para;</a></h3>
<p>The artificial viscosity scheme, proposed by [Monaghan, 1992], is a common method
within fluid simulation using SPH due primarily to its simplicity. In SPH notation, Eq. 6
can be written as</p>
<p align="center">
<img src="https://i.imgur.com/6MwDAHJ.png"/> (7)
</p>

<p>where P<sub>k</sub> and ρ<sub>k</sub> are the pressure and density that correspond to particle k (as evaluated
at a or b). The viscosity term <img src="https://i.imgur.com/jIBQoNg.png" /> is given by</p>
<p align="center">
<img src="https://i.imgur.com/PNAdFht.png"/> (8)
</p>

<p>where ab <strong>r</strong>_ab=<strong>r</strong>_a-<strong>r</strong>_b and <strong>v</strong>_ab=<strong>v</strong>a-<strong>v</strong>b with <strong>r</strong>_k and <strong>v</strong>_k being the particle position and velocity respectively. <img src="https://i.imgur.com/0WtDphK.png" /> is the mean speed of sound, <img src="https://i.imgur.com/z8fQyJ8.png"/> and α is a coefficient that needs to be tuned in order to introduce the proper dissipation. The value of α=0.01 has proven to give the best results in the
validation of wave flumes to study wave propagation and wave loadings exerted onto
coastal structures [Altomare et al. (2015a)].</p>
<h3 id="laminar_viscosity_and_sub-particle_scale_sps_turbulence">Laminar viscosity and Sub-Particle Scale (SPS) Turbulence<a class="headerlink" href="#laminar_viscosity_and_sub-particle_scale_sps_turbulence" title="Permanent link">&para;</a></h3>
<p>Laminar viscous stresses in the momentum equation can be expressed as [Lo and Shao,
2002]</p>
<p align="center">
<img src="https://i.imgur.com/P7BXWYL.png"/> (9)
</p>

<p>where υo is kinematic viscosity (typically 10^(-6) for water). In SPH discrete notation
this can be expressed as</p>
<p align="center">
<img src="https://i.imgur.com/UhXKZwz.png"/> (10)
</p>

<p>The concept of the Sub-Particle Scale (SPS) was first described by [Gotoh et al., 2001]
to represent the effects of turbulence in their Moving Particle Semi-implicit (MPS)
model. The momentum conservation equation is defined as</p>
<p align="center">
<img src="https://i.imgur.com/PrCkxCv.png"/> (11)
</p>

<p>where the laminar term is treated as per Eq. 9 and <img src="https://i.imgur.com/GCGmUXz.png" /> represents the SPS stress tensor. Favre-averaging is needed to account for compressibility in weakly compressible SPH
[Dalrymple and Rogers, 2006] where eddy viscosity assumption is used to model the
SPS stress tensor with Einstein notation for the shear stress component in coordinate
directions i and j <img src="https://i.imgur.com/z7vOxa2.png" /> where <img src="https://i.imgur.com/Ijsxbkq.png" /> is the sub-particle stress
tensor, <img src="https://i.imgur.com/cETvBL8.png" /> the turbulent eddy viscosity, k the SPS turbulence kinetic
energy, Cs the Smagorinsky constant (0.12), CI=0.0066, <img src="https://i.imgur.com/HS6vhQh.png" /> the particle to particle spacing and <img src="https://i.imgur.com/OtlzhLP.png" /> where <img src="https://i.imgur.com/CaDoLwa.png" /> is an element of the SPS strain tensor. [Dalrymple and Rogers, 2006] introduced SPS into weakly compressible SPH using Favre averaging, Eq.11 can be re-written as</p>
<p align="center">
<img src="https://i.imgur.com/RUG9SJF.png"/> (12)
</p>

<h3 id="33_continuity_equation">3.3 Continuity equation<a class="headerlink" href="#33_continuity_equation" title="Permanent link">&para;</a></h3>
<p>Throughout the duration of a weakly-compressible SPH simulation (as presented
herein) the mass of each particle remains constant and only their associated density
fluctuates. These density changes are computed by solving the conservation of mass, or
continuity equation, in SPH form:</p>
<p align="center">
<img src="https://i.imgur.com/CTsBQPl.png"/> (13)       
</p>

<h2 id="34_equation_of_state">3.4 Equation of state<a class="headerlink" href="#34_equation_of_state" title="Permanent link">&para;</a></h2>
<p>Following the work of [Monaghan, 1994], the fluid in the SPH formalism defined in
DualSPHysics is treated as weakly compressible and an equation of state is used to
determine fluid pressure based on particle density. The compressibility is adjusted so that
the speed of sound can be artificially lowered; this means that the size of time step taken
at any one moment (which is determined according to a Courant condition, based on the
currently calculated speed of sound for all particles) can be maintained at a reasonable
value. Such adjustment however, restricts the sound speed to be at least ten times faster
than the maximum fluid velocity, keeping density variations to within less than 1%, and
therefore not introducing major deviations from an incompressible approach. Following
[Monaghan et al., 1999] and [Batchelor, 1974], the relationship between pressure and
density follows the expression</p>
<p align="center">
<img src="https://i.imgur.com/zbT9A4G.png"/> (14)
</p>

<p>where <img src="https://i.imgur.com/noiD8EZ.png" /> where <img src="https://i.imgur.com/b9ppfL9.png" /> is the reference density and <img src="https://i.imgur.com/xDA7oho.png" /> which is the speed of sound at the reference density.</p>
<h2 id="35_density_diffusion_term">3.5 Density diffusion term<a class="headerlink" href="#35_density_diffusion_term" title="Permanent link">&para;</a></h2>
<p>Within DualSPHysics it is also possible to apply a density diffusion term, that
introduces a diffusive term to reduce density fluctuations. The state equation describes a
very stiff density field, and together with the natural disordering of the
particles, high-frequency low amplitude oscillations are found to populate the density
scalar field. DualSPHysics uses a diffusive term in the
continuity equation, now written as</p>
<p align="center">
<img src="https://i.imgur.com/mRVNwfw.png"/> (15.1)      
</p>

<p>with,</p>
<p align="center">
<img src="https://i.imgur.com/p6J9R8x.png"/> (15.2)   
</p>

<p>This represents the density diffusion formulation by [Molteni and Colagrossi, 2009],
with a free parameter that needs to be attributed a suitable value. This modification
can be explained as the addition of the Laplacian of the density field to the continuity
equation. [Antuono et al., 2012] has presented a careful analysis of the influence of this
term in the system, by decomposing the Laplacian operator, observing the converge of
the operators and performing linear stability analysis to inspect the influence of the
diffusive coefficient. This equation represents exactly a diffusive term in the domain
bulk. The behaviour changes close to open boundaries such as free-surface. Due to
truncation of the kernel (there are no particles being sampled outside of an open
boundary), the first-order contributions are not null [Antuono et al., 2010], resulting in a
net force applied to the particles. This effect is not considered relevant for nonhydrostatic
situations, where this force is many orders of magnitude inferior to any
other force involved. Corrections to this effect were proposed by [Antuono et al., 2010],
but involve the solution of a renormalization problem for the density gradient, with
considerable computational cost. A (<em>δ</em><sub><em>Φ</em></sub>) coefficient of 0.1 is recommended
for most applications.</p>
<p>The work of [Fourtakas et al., 2020] introduces a correction in Eq. (15.2). The key idea is to use the same formulation proposed by [Molteni and Colagrossi, 2009] but substituting the dynamic density with the total one. Thus, the term <em>ψ</em><sub><em>ab</em></sub> takes the following form,</p>
<p align="center">
<img src="https://i.imgur.com/sBfTPgw.png"/> (16)  
</p>

<p>where the superscript <em>D</em> denotes the dynamic density or pressure. Since <em>ρ</em><sub><em>D</em></sub>=<em>ρ</em><sub><em>T</em></sub>-<em>ρ</em><sub><em>H</em></sub> (where superscript <em>T</em> and <em>H</em> denote the total and hydrostatic component, respectively), Eq. (16) can be rewritten in term of the hydrostatic and total parts as, </p>
<p align="center">
<img src="https://i.imgur.com/ndN6ySn.png"/> (17)  
</p>

<p>In the context of the weakly compressible SPH, the equation of state relates the density to the total pressure at the particle location. However, only the hydrostatic part of the pressure is needed. Using the equation of state (EOS), the hydrostatic density difference can be obtained by,</p>
<p align="center">
<img src="https://i.imgur.com/GaMbfSg.png"/> (18) 
</p>

<p>The term <em>P</em><sup><em>H</em></sup> is simply the hydrostatic pressure difference of particle <em>a</em> and <em>b</em>,</p>
<p align="center">
<img src="https://i.imgur.com/m2UHAnl.png"/> (19) 
</p>

<p>where <em>z</em><sub><em>ab</em></sub> is the vertical distance between particle <em>a</em> and <em>b</em> and</p>
<p align="center">
<img src="https://i.imgur.com/SPKMCml.png"/> (20)   
</p>

<p>In comparison with the formulation of the diffusive term proposed by [Molteni and Colagrossi, 2009] of Eq. (15.2), Eq. (16) improves the behaviour of pressure near the wall boundaries by avoiding the troublesome dynamic pressure and avoiding to compute the normalized density gradient. However, it must be noted that the formulation of [Antuono et al., 2010] is consistent and it can be adopted for any type of flow, whereas the use of total density in the diffusive term of Eq. (16) is expected to work better than Eq. (15.2) mostly for gravity-dominated flows. In the absence of a gravity force the formulation collapses to the original formulation of [Molteni and Colagrossi, 2009].</p>
<h2 id="36_shifting_algorithm">3.6 Shifting algorithm<a class="headerlink" href="#36_shifting_algorithm" title="Permanent link">&para;</a></h2>
<p>Anisotropic particle spacing is an important stability issue in SPH as, especially in
violent flows, particles cannot maintain a uniform distribution. The result is the
introduction of noise in the velocity and pressure field, as well as the creation of voids
within the water flow for certain cases.</p>
<p>To counter the anisotropic particle spacing, [Xu et al., 2009] proposed a particle shifting
algorithm to prevent the instabilities. The algorithm was first created for incompressible
SPH, but can be extended to the weakly compressible SPH model used in
DualSPHysics [Vacondio et al., 2013]. With the shifting algorithm, the particles are
moved (&ldquo;shifted&rdquo;) towards areas with fewer particles (lower particle concentration)
allowing the domain to maintain a uniform particle distribution and eliminating any
voids that may occur due to the noise.</p>
<p>An improvement on the initial shifting algorithm was proposed by [Lind et al., 2012]
who used Fick&rsquo;s first law of diffusion to control the shifting magnitude and direction.
Fick&rsquo;s first law connects the diffusion flux to the concentration gradient:</p>
<p align="center">
<img src="https://i.imgur.com/N4Ufk40.png"/> (21)
</p>

<p>where J is the flux, C the particle concentration, and D<sub>F</sub> the Fickian diffusion coefficient.</p>
<p>Assuming that the flux, i.e. the number of particles passing through a unit surface in
unit time, is proportional to the velocity of the particles, a particle shifting velocity and
subsequently a particle shifting distance can be found. Using the particle concentration,
the particle shifting distance δr<sub>s</sub> is given by:</p>
<p align="center">
<img src="https://i.imgur.com/UZtavpb.png"/> (22)
</p>

<p>where D is a new diffusion coefficient that controls the shifting magnitude and absorbs
the constants of proportionality. The gradient of the particle concentration can be found
through an SPH gradient operator:</p>
<p align="center">
<img src="https://i.imgur.com/c6fJZ7j.png"/> (23)
</p>

<p>The proportionality coefficient D is computed through a form proposed by [Skillen et
al., 2013]. It is set to be large enough to provide effective particle shifting, while not
introducing significant errors or instabilities. This is achieved by performing a Von
Neumann stability analysis of the advection-diffusion equation:</p>
<p align="center">
<img src="https://i.imgur.com/6d2cuqH.png"/> (24)
</p>

<p>where Δt<sub>max</sub> is the maximum local time step that is permitted by the CFL condition for a
given local velocity and particle spacing. The CFL condition states that:</p>
<p align="center">
<img src="https://i.imgur.com/14FfvsR.png"/> (25)
</p>

<p>Combining Eq. 24 and 25 we can derive an equation to find the shifting coefficient D:</p>
<p align="center">
<img src="https://i.imgur.com/H42Ukai.png"/> (26)
</p>

<p>where A is a dimensionless constant that is independent of the problem setup and
discretization and dt is the current time step. Values in the range of [1,6] are proposed
with 2 used as default.</p>
<p>The shifting algorithm is heavily dependent on a full kernel support. However, particles
at and adjacent to the free surface cannot obtain the full kernel support, which will
introduce errors in the free-surface prediction, potentially causing non-physical
instabilities. Applying Fick&rsquo;s law directly would result in the rapid diffusion of fluid
particles from the fluid bulk, due to the large concentration gradients at the free surface.</p>
<p>To counter this effect, [Lind et al., 2012] proposed a free-surface correction that limits
diffusion to the surface normal but allow shifting on the tangent to the free surface.
Therefore, this correction is only used near the free surface, identified by the value of
the particle divergence, which is computed through the following equation, first
proposed by [Lee et al., 2008]:</p>
<p align="center">
<img src="https://i.imgur.com/x6jnVya.png"/> (27)
</p>

<p>This idea is applied to the DualSPHysics code by multiplying the shifting distance of
Equation (22) with a free-surface correction coefficient AFSC.</p>
<p align="center">
<img src="https://i.imgur.com/o0itVZQ.png"/> (28.1)
</p>

<p>where AFST is the free-surface threshold and AFSM is the maximum value of the particle
divergence. The latter depends on the domain dimensions:</p>
<p align="center">
<img src="https://i.imgur.com/Yz8AusQ.png"/> (28.2)
</p>

<p>while the free surface threshold is selected for DualSPHysics as:</p>
<p align="center">
<img src="https://i.imgur.com/SE2ii1z.png"/> (28.3)
</p>

<p>To identify the position of the particle relative to the free surface, the difference of the
particle divergence to AFST is used. Therefore, the full shifting equation (Eq. 22) with the
free surface correction is:</p>
<p align="center">
<img src="https://i.imgur.com/G2RY5Yu.png"/> (29)      
</p>

<p>More information about the shifting implementation can be found in [Mokos, 2013].</p>
<h2 id="37_time_stepping">3.7 Time stepping<a class="headerlink" href="#37_time_stepping" title="Permanent link">&para;</a></h2>
<p>In DualSPHysics two explicit time integration schemes are implemented. For brevity, the governing equations are written as </p>
<p align="center">
<img src="https://i.imgur.com/kzpoD9e.png"/>    
</p>

<p>These equations are integrated in time using a computationally simple Verlet based
scheme or a more numerically stable but computationally intensive two-stage
Symplectic method.</p>
<h3 id="371_verlet_scheme">3.7.1 Verlet scheme<a class="headerlink" href="#371_verlet_scheme" title="Permanent link">&para;</a></h3>
<p>The Verlet scheme [Verlet, 1967] is commonly used in molecular dynamics since it is a low computational cost scheme with a second order accurate space integrator that does not require multiple calculation steps within an iteration interval, the WCSPH variables are calculated according to</p>
<p align="center">
<img src="https://i.imgur.com/nqlcXSb.png"/> (30)   
</p>

<p>Due to the integration over a staggered time interval, the equations of density and velocity are decoupled, which may lead to divergence of the integrated values. Therefore, an intermediate step is required every N_S steps (Ns≈40 is recommended) according to</p>
<p align="center">
<img src="https://i.imgur.com/1HPIRtl.png"/> (31)    
</p>

<p>where the subscript <em>n</em> denotes the time step and <em>t</em>= <em>nΔt</em></p>
<h3 id="372_symplectic_position_verlet_scheme">3.7.2 Symplectic Position Verlet scheme<a class="headerlink" href="#372_symplectic_position_verlet_scheme" title="Permanent link">&para;</a></h3>
<p>The symplectic position Verlet time integrator scheme [Leimkuhler and Matthews, 2016] is second order accurate in time. It is ideal for Lagrangian schemes as it is time reversible and symmetric in the absence of diffusive terms that preserve geometric futures. The position Verlet scheme in the absence of dissipation forces reads, </p>
<p align="center">
<img src="https://i.imgur.com/GpljYGY.png"/> (32)   
</p>

<p>However, in the presence of viscous forces and density evolution in DualSPHysics, the velocity is required in n+1/2 step thus, a velocity Verlet half step is used to compute the required velocity for the acceleration and density evolution for <img src="https://i.imgur.com/IWYnnF6.png" /> and <img src="https://i.imgur.com/WxrRmQJ.png" /> respectively. The scheme implemented in DualSPHysics reads,</p>
<p align="center">
<img src="https://i.imgur.com/BX60V6e.png"/> (33)     
</p>

<p>where <img src="https://i.imgur.com/3PB1yqV.png" /> is substituted to <img src="https://i.imgur.com/1rY4BOR.png" /> in Eq. 32 to eliminate dependence on <img src="https://i.imgur.com/MO9iU7a.png" />.</p>
<p>Finally, the density evolution follows the half time steps of the symplectic position Verlet scheme as follows [Parshikov et al, 2000], </p>
<p align="center">
<img src="https://i.imgur.com/AR6RY84.png"/> (34)    
</p>

<p>where <img src="https://i.imgur.com/onHyc7t.png" />.</p>
<h3 id="373_variable_time_step">3.7.3 Variable time step<a class="headerlink" href="#373_variable_time_step" title="Permanent link">&para;</a></h3>
<p>With explicit time integration schemes the timestep is dependent on the Courant-
Friedrichs-Lewy (CFL) condition, the forcing terms and the viscous diffusion term. A
variable time step Δt is calculated according to [Monaghan et al., 1999] using</p>
<p align="center">
<img src="https://i.imgur.com/XjFLZ1F.png"/> (35)  
</p>

<p>where Δtf is based on the force per unit mass (|fa|), and Δtcv combines the Courant and
the viscous time step controls.</p>
<h2 id="features">Features<a class="headerlink" href="#features" title="Permanent link">&para;</a></h2>
<ul>
<li><a id="Monaghan1992"></a> <strong>Monaghan1992</strong>: Monaghan1992 of feature 1.</li>
<li><a id="feature-2"></a> <strong>Feature 2</strong>: Description of feature 2.</li>
<li><a id="feature-3"></a> <strong>Feature 3</strong>: Description of feature 3.</li>
</ul>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
  <footer class="md-footer">
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          
            <div class="md-footer-copyright__highlight">
              &copy; 2024 IM-POWER Project
            </div>
          
          
            
              <div class="md-footer-copyright__highlight">
                IM-POWER has received funding from the European Union's Horizon 2020 research and innovation programme under the Marie Skłodowska-Curie grant agreement No 101109440.
              </div>
            
          
        </div>
        
          <div class="md-footer-copyright">
            Made with
            <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
              Material for MkDocs
            </a>
          </div>
        
      </div>
    </div>
  </footer>

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.top", "navigation.tabs", "navigation.expand", "navigation.instant.progress", "navigation.tracking", "navigation.sections", "navigation.footer"], "search": "../../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.56dfad97.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>